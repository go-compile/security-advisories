<img style="height: 100px;" src="../images/adguardhome.png">
# Privilege Escalation in AdGuardHome
> CVE-2024-36586

An issue in AdGuardHome v0.93 to latest allows unprivileged attackers to escalate privileges via overwriting the AdGuardHome binary.

## Summary

Vendor: `AddGuard` </br>
Product: `AddGuardHome (open-source)` </br>
Vulnerability Type: `Privilege escalation` </br>
Attack Type: `Local` </br>
Impact: `Code Execution & privilege escalation` </br>
Attack Vectors: `Binary planting` </br>
Affected Component: `AdGuardHome -s install` </br>
Affected Versions: `v0.93 to latest (June 2024)` </br>
Sophistication: `Low` </br>
Opperating Systems: `Linux, openBSD, MacOS, and Windows (UAC bypass)` </br>

## Attack Vector

To exploit this vulnerability an attacker must overwrite the AdGuardHome binary, replacing it with the malicious payload. Next the attacker must either wait or induce a restart of the daemon process, which will then execute the malicious payload under the user LocalSystem (Windows) or Root (Linux). However, the AdGuardHome service must already be installed.

## Affected Components
```sh
./AdGuardHome -s install
```
```
/internal/home/service.go
```
```go
func (p *program) Start(_ service.Service) (err error)
```

</br>
</br>

## References
[https://github.com/AdguardTeam/AdGuardHome/pull/6748](https://github.com/AdguardTeam/AdGuardHome/pull/6748)

---

CC BY-SA - June 2024
