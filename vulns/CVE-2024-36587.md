<img style="float: right; height: 100px; padding-top: 50px" src="../images/dnscrypt-proxy-logo.png">

# Privilege Escalation in Dnscrypt-proxy
> CVE-2024-36587


Insecure permissions in DNSCrypt-proxy v2.0.0alpha9 to v2.1.5 allows non-privileged attackers to escalate privileges to root via overwriting the binary dnscrypt-proxy.

## Summary

Vendor: `DNSCrypt` </br>
Product: `dnscrypt-proxy (open-source)` </br>
Vulnerability Type: `Privilege escalation` </br>
Attack Type: `Local` </br>
Impact: `Code Execution & privilege escalation` </br>
Attack Vectors: `Binary planting` </br>
Affected Component: `dnscrypt-proxy/dnscrypt-proxy/main.go` </br>
Affected Versions: `2.0.0 alpha9 to latest (June 2024)` </br>
Sophistication: `Low` </br>
Opperating Systems: `Linux, openBSD, MacOS, and Windows (UAC bypass)` </br>

## Attack Vector

If dnscrypt-proxy has been installed as a service via ./dnscrypt-proxy -service install following the dnscrypt-proxyâ€™s installation guide (DNScrypt, 2022) a non root user can overwrite the binary dnscrypt-proxy with a malicious payload which will then be executed as root next time the dnscrypt-proxy service restarts (e.g. after reboot).

On windows the attack works the same, except the user gains LocalSystem privileges, bypassing UAC.

## Affected Components
```sh
./dnscrypt-proxy -service install
```
```
dnscrypt-proxy/dnscrypt-proxy/main.go
```
```go
func (p *program) Start(_ service.Service) (err error)
```

</br>
</br>

## References
https://github.com/DNSCrypt/dnscrypt-proxy/issues/2579

---

CC BY-SA - June 2024